<!DOCTYPE html>
<html>
<head>
    <title>Sultan Chain Dashboard</title>
    <style>
        body { font-family: monospace; background: #1a1a1a; color: #0f0; padding: 20px; }
        .container { max-width: 1200px; margin: auto; }
        h1 { text-align: center; color: #0f0; text-shadow: 0 0 10px #0f0; }
        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 20px 0; }
        .stat-box { background: #000; border: 1px solid #0f0; padding: 15px; text-align: center; }
        .stat-box h3 { color: #888; margin: 5px; }
        .stat-box h2 { color: #0f0; margin: 5px; }
        .blocks { background: #000; border: 1px solid #0f0; padding: 20px; margin: 20px 0; max-height: 600px; overflow-y: auto; }
        .block { border-bottom: 1px solid #333; padding: 10px 0; }
        .block:last-child { border-bottom: none; }
        button { background: #0f0; color: #000; border: none; padding: 10px 20px; cursor: pointer; margin: 5px; font-weight: bold; }
        button:hover { background: #00ff00cc; }
        .error { color: #f00; padding: 10px; background: #200; border: 1px solid #f00; margin: 10px 0; }
        .success { color: #0f0; padding: 10px; background: #020; border: 1px solid #0f0; margin: 10px 0; }
        #status { margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸš€ SULTAN CHAIN - ZERO GAS BLOCKCHAIN ðŸš€</h1>
        <div id="status"></div>
        <div class="stats">
            <div class="stat-box">
                <h3>Gas Fees</h3>
                <h2>$0.00</h2>
            </div>
            <div class="stat-box">
                <h3>Target TPS</h3>
                <h2 id="tps">10,000,000</h2>
            </div>
            <div class="stat-box">
                <h3>Total Blocks</h3>
                <h2 id="blockCount">Loading...</h2>
            </div>
        </div>
        
        <div style="text-align: center;">
            <button onclick="addTransaction()">Add Test Transaction</button>
            <button onclick="refreshData()">Refresh Now</button>
            <button onclick="clearStatus()">Clear Messages</button>
        </div>
        
        <div class="blocks">
            <h2>Recent Blocks</h2>
            <div id="blockList">Loading...</div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:8081';
        
        function showStatus(message, isError = false) {
            const status = document.getElementById('status');
            status.className = isError ? 'error' : 'success';
            status.innerHTML = message;
            setTimeout(() => { status.innerHTML = ''; }, 5000);
        }
        
        function clearStatus() {
            document.getElementById('status').innerHTML = '';
        }
        
        async function refreshData() {
            try {
                const response = await fetch(`${API_URL}/blocks`);
                if (!response.ok) throw new Error('API not responding');
                
                const blocks = await response.json();
                document.getElementById('blockCount').innerText = blocks.length;
                
                const blockList = document.getElementById('blockList');
                blockList.innerHTML = blocks.reverse().slice(0, 10).map(block => `
                    <div class="block">
                        <strong style="color: #0f0;">Block #${block.index}</strong><br>
                        <span style="color: #888;">Time:</span> ${new Date(block.timestamp).toLocaleString()}<br>
                        <span style="color: #888;">Data:</span> ${block.data}<br>
                        <span style="color: #888;">Hash:</span> ${block.hash.substring(0, 32)}...<br>
                        <span style="color: #888;">Gas Fee:</span> <strong style="color: #0f0;">$${block.gasFee.toFixed(2)}</strong>
                    </div>
                `).join('');
            } catch (err) {
                console.error('Error fetching data:', err);
                document.getElementById('blockList').innerHTML = '<div style="color: #f00;">Unable to connect to Sultan Chain on port 8081</div>';
            }
        }
        
        async function addTransaction() {
            try {
                const timestamp = new Date().toISOString();
                const response = await fetch(`${API_URL}/block`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({data: `Transaction at ${timestamp} - Zero Gas!`})
                });
                
                if (!response.ok) throw new Error('Failed to add transaction');
                
                const block = await response.json();
                showStatus(`Successfully added Block #${block.index} with ZERO gas fees!`);
                refreshData();
            } catch (err) {
                console.error('Error adding transaction:', err);
                showStatus('Error: Unable to add transaction. Make sure Sultan Chain is running.', true);
            }
        }
        
        // Initial load
        refreshData();
        
        // Auto-refresh every 5 seconds
        setInterval(refreshData, 5000);
    </script>
</body>
</html>
