version: '3.8'

services:
  sultand:
    image: cosmosconformance/simapp:latest
    container_name: sultan-cosmos
    ports:
      - "26656:26656"  # P2P
      - "26657:26657"  # RPC
      - "1317:1317"    # REST API
      - "9090:9090"    # gRPC
    environment:
      - CHAIN_ID=sultan-1
      - MONIKER=sultan-node
      - MINIMUM_GAS_PRICES=0stake
    volumes:
      - ./sultan-data:/root/.simapp
    command: |
      sh -c "
        simd init sultan-node --chain-id sultan-1 &&
        simd keys add validator --keyring-backend test &&
        simd genesis add-genesis-account validator 1000000000stake --keyring-backend test &&
        simd genesis gentx validator 1000000stake --keyring-backend test --chain-id sultan-1 &&
        simd genesis collect-gentxs &&
        simd start --minimum-gas-prices 0stake
      "
